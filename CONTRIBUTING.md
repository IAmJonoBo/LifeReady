# Contributing

Thanks for helping on LifeReady SA. This repo is contract-first and drift-sensitive, so please follow these steps.

## Development setup

1. Install the OpenAPI generator wrapper:

   ```bash
   npm install --prefix tools/openapi
   ```

2. Validate and generate stubs:

   ```bash
   make validate-openapi
   make generate-axum
   ```

3. Start local Postgres:

   ```bash
   make dev-up
   ```

4. Configure environment:

   ```bash
   cp .env.example .env
   ```

5. Run migrations:

   ```bash
   cargo install sqlx-cli --no-default-features --features postgres
   make db-migrate
   ```

## Code generation rules

- Update OpenAPI specs first, then run make generate-axum.
- Do not edit services/service/generated by hand.
- Generated stubs under services/\*/generated are committed to the repo.
- CI regenerates stubs and fails on git diff --exit-code.
- Regenerate Flutter tokens after token changes:

  ```bash
  make generate-flutter-tokens
  ```

## Testing

- Rust:

  ```bash
  cargo fmt --check
  cargo clippy --workspace --all-targets --all-features
  cargo test --workspace --all-targets --all-features
  ```

- Flutter:

  ```bash
  make flutter-check
  ```

## Pull requests

- Keep PRs focused and small where possible.
- Include contract updates and regeneration for any API changes.
- CI will fail on generated drift; run the generators locally before pushing.
